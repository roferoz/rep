
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>COMTEL S.A. - Registro de Proveedores</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background-color: #f4f6f9;
      color: #002f6c;
      padding: 20px;
    }
    input, button {
      padding: 10px;
      margin: 5px 0;
      border-radius: 5px;
    }
    button {
      border: none;
      cursor: pointer;
    }
    .modal {
      display: none;
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background-color: rgba(0,0,0,0.5);
      justify-content: center;
      align-items: center;
      z-index: 999;
    }
    .modal.show {
      display: flex;
    }
    .modal-content {
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      width: 90%;
      max-width: 400px;
      position: relative;
    }
    table {
      width: 100%;
      margin-top: 15px;
      border-collapse: collapse;
    }
    th, td {
      padding: 10px;
      border: 1px solid #ccc;
    }
    th {
      background-color: #002f6c;
      color: white;
    }
    .actions button {
      margin-right: 5px;
      background-color: #007acc;
      color: white;
    }
  </style>
</head>
<body>

<div id="login-section">
  <h2>Acceso</h2>
  <input type="text" id="username" placeholder="Usuario"><br>
  <input type="password" id="password" placeholder="Contraseña"><br>
  <button onclick="login()" style="background:#002f6c; color:white;">Ingresar</button>
</div>

<div id="main-content" style="display:none;">
  <h2>Registro de Proveedores</h2>

  <!-- Search Bar -->
  <div style="margin-bottom: 15px;">
    <input type="text" id="busqueda" placeholder="Buscar en registros..." style="width: 300px; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
    <button onclick="buscarRegistros()" style="background: #28a745; color: white;">Buscar</button>
    <button onclick="restablecerBusqueda()" style="background: #6c757d; color: white;">Restablecer</button>
  </div>

  <button onclick="document.getElementById('nuevo-modal').classList.add('show')" style="background: #007acc; color:white;">Nuevo Registro</button>

  <table id="tabla-registros">
    <thead>
      <tr>
        <th>Marca/Proveedor</th>
        <th>Contacto</th>
        <th>Email</th>
        <th>Teléfono</th>
        <th>Detalles</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<!-- Modal: Nuevo Registro -->
<div id="nuevo-modal" class="modal">
  <div class="modal-content">
    <span onclick="document.getElementById('nuevo-modal').classList.remove('show')" style="position:absolute;top:10px;right:15px;cursor:pointer;">×</span>
    <h3>Nuevo Registro</h3>
    <input type="text" id="nuevo-marca" placeholder="Marca/Proveedor"><br>
    <input type="text" id="nuevo-contacto" placeholder="Contacto"><br>
    <input type="email" id="nuevo-email" placeholder="Email"><br>
    <input type="text" id="nuevo-telefono" placeholder="Teléfono"><br>
    <input type="text" id="nuevo-detalles" placeholder="Detalles"><br>
    <button onclick="guardarNuevoRegistro()" style="background:#002f6c; color:white;">Agregar</button>
    <button onclick="document.getElementById('nuevo-modal').classList.remove('show')" style="background:#999; color:white;">Cancelar</button>
  </div>
</div>

<!-- Modal: QR -->
<div id="qr-modal" class="modal">
  <div class="modal-content" style="text-align:center;">
    <span onclick="document.getElementById('qr-modal').classList.remove('show')" style="position:absolute;top:10px;right:15px;cursor:pointer;">×</span>
    <div id="qr-code"></div>
  </div>
</div>

<script>
  let registros = [];

  function login() {
    const user = document.getElementById('username').value;
    const pass = document.getElementById('password').value;
    if (user === 'admin' && pass === '1234') {
      document.getElementById('login-section').style.display = 'none';
      document.getElementById('main-content').style.display = 'block';
      cargarRegistros();
    } else {
      alert('Credenciales incorrectas');
    }
  }

  function guardarNuevoRegistro() {
    const nuevo = {
      marca: document.getElementById('nuevo-marca').value,
      contacto: document.getElementById('nuevo-contacto').value,
      email: document.getElementById('nuevo-email').value,
      telefono: document.getElementById('nuevo-telefono').value,
      detalles: document.getElementById('nuevo-detalles').value
    };
    if (!nuevo.marca || !nuevo.contacto || !nuevo.email || !nuevo.telefono) {
      alert('Complete todos los campos obligatorios');
      return;
    }
    registros.push(nuevo);
    localStorage.setItem('registros', JSON.stringify(registros));
    document.getElementById('nuevo-modal').classList.remove('show');
    cargarRegistros();
  }

  function cargarRegistros() {
    registros = JSON.parse(localStorage.getItem('registros') || '[]');
    const tbody = document.querySelector('#tabla-registros tbody');
    tbody.innerHTML = '';
    registros.forEach((r, i) => {
      const fila = `<tr>
        <td>${r.marca}</td>
        <td>${r.contacto}</td>
        <td>${r.email}</td>
        <td>${r.telefono}</td>
        <td>${r.detalles}</td>
        <td class='actions'>
          <button onclick="mostrarQR('${r.telefono}')">Detalles</button>
          <button onclick="eliminarRegistro(${i})">Eliminar</button>
        </td>
      </tr>`;
      tbody.innerHTML += fila;
    });
  }

  function eliminarRegistro(i) {
    if (confirm('¿Desea eliminar este registro?')) {
      registros.splice(i, 1);
      localStorage.setItem('registros', JSON.stringify(registros));
      cargarRegistros();
    }
  }

  function mostrarQR(telefono) {
    const qrDiv = document.getElementById('qr-code');
    qrDiv.innerHTML = '';
    const qr = new QRious({
      element: document.createElement('canvas'),
      size: 200,
      value: `tel:${telefono}`
    });
    qrDiv.appendChild(qr.element);
    document.getElementById('qr-modal').classList.add('show');
  }

  function buscarRegistros() {
    const texto = document.getElementById("busqueda").value.toLowerCase();
    const tbody = document.querySelector("#tabla-registros tbody");
    tbody.innerHTML = "";
    const registrosBuscados = JSON.parse(localStorage.getItem("registros") || "[]");
    registrosBuscados.forEach((r, i) => {
      const contenido = `${r.marca} ${r.contacto} ${r.email} ${r.telefono} ${r.detalles}`.toLowerCase();
      if (contenido.includes(texto)) {
        const fila = `<tr>
          <td>${r.marca}</td>
          <td>${r.contacto}</td>
          <td>${r.email}</td>
          <td>${r.telefono}</td>
          <td>${r.detalles}</td>
          <td class='actions'>
            <button onclick="mostrarQR('${r.telefono}')">Detalles</button>
            <button onclick="eliminarRegistro(${i})">Eliminar</button>
          </td>
        </tr>`;
        tbody.innerHTML += fila;
      }
    });
  }

  function restablecerBusqueda() {
    document.getElementById("busqueda").value = "";
    cargarRegistros();
  }
</script>
</body>
</html>
